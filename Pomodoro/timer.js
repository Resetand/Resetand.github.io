"use strict";var WORK_TIME=1500,REST_TIME=300;function change_favicon(a){var b=document.querySelector("link[rel=\"shortcut icon\"]");if(!b){b=document.createElement("link"),b.setAttribute("rel","shortcut icon");var c=document.querySelector("head");c.appendChild(b)}b.setAttribute("type","image/png"),b.setAttribute("href",a)}var $={el:document.getElementById("time"),startBtn:document.getElementById("start"),pauseBtn:document.getElementById("pause"),brakeBtn:document.getElementById("brake"),progress:document.getElementById("progress-bar"),state:document.getElementById("state"),pomodoroCounter:0,startCounter:0,isWork:!0,isRest:!1,isPause:!1,isBrake:!1,wokrTime:1500,restTime:REST_TIME,toDisplay:function(a){var b=Math.floor(a/3600),c=Math.floor(a/60),d=a%60;return""+(b?b+" : ":"")+(10<=c?c+" : ":"0"+c+" : ")+(10<=d?d:"0"+d)},toDisplaySmaller:function(a){var b=Math.floor(a/3600),c=Math.floor(a/60),d=a%60;return""+(b?b+":":"")+(10<=c?c+":":"0"+c+":")+(10<=d?d:"0"+d)},tickWork:function(){return this.wokrTime--,this.el.innerHTML=this.toDisplay(this.wokrTime),document.title=this.toDisplaySmaller(this.wokrTime),"#d2494a"!==this.progress.style.backgroundColor&&(this.progress.style.backgroundColor="#d2494a"),this.progress.style.width=100-100*this.wokrTime/WORK_TIME+"%",this.wokrTime},tickRest:function(){return this.restTime--,this.el.innerHTML=this.toDisplay(this.restTime),document.title=this.toDisplaySmaller(this.restTime),"#4fb326"!==this.progress.style.backgroundColor&&(this.progress.style.backgroundColor="#4fb326"),this.progress.style.width=100-100*this.restTime/REST_TIME+"%",this.restTime},onStart:function(){0===this.startCounter&&(this.isWork?(this.isBrake=!1,this.isPause=!1,this.timerInit()):this.isRest&&(this.isBrake=!1,this.isPause=!1,this.timerInit())),this.startCounter++},onPause:function(a){clearInterval(a),this.isPause=!0,this.isBrake=!1,this.startCounter=0},onBrake:function(a){this.isWork=!0,this.isRest=!1,this.isPause=!0,this.isBrake=!0,this.startCounter=0,this.pomodoroCounter=0,this.wokrTime=WORK_TIME,this.restTime=REST_TIME,this.progress.style.width=0,this.state.innerHTML="Code time !",this.el.innerHTML=this.toDisplay(this.wokrTime),clearInterval(a)},onEnd:function(a){clearInterval(a),alert("\u041F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u044C ?"),this.isWork?(this.isWork=!1,this.isRest=!0,this.timerInit()):this.isRest&&(this.isWork=!0,this.isRest=!1,this.wokrTime=WORK_TIME,this.restTime=REST_TIME,this.timerInit(),this.pomodoroCounter++)},workingEffects:function(){change_favicon("./work.ico"),this.state.innerHTML="Code time !"},restingEffects:function(){change_favicon("./rest.ico"),this.state.innerHTML="Time to break !"},timerInit:function(){var a=this;this.state.style.opacity=1;var b=this;if(this.isWork){var c;(function(){var d=a.tickWork;a.workingEffects(),c=setInterval(function(){0<b.wokrTime?(!b.isPause&&!b.isBrake&&d.call(b),b.isPause&&b.onPause(c),b.isBrake&&b.onBrake(c)):b.onEnd(c)},1e3)})()}this.isRest&&function(){var c=a.tickRest;a.restingEffects();var d=setInterval(function(){0<b.restTime?(!b.isPause&&!b.isBrake&&c.call(b),b.isPause&&b.onPause(d),b.isBrake&&b.onBrake(d)):b.onEnd(d)},1e3)}()}};document.title=$.toDisplaySmaller(1500),$.el.innerHTML=$.toDisplay(1500),$.startBtn.addEventListener("click",function(){$.onStart()}),$.pauseBtn.addEventListener("click",function(){$.onPause()}),$.brakeBtn.addEventListener("click",function(){$.onBrake()});
